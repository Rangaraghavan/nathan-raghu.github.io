<!DOCTYPE html>
<html>
<head>
	<title></title>
	<meta charset="utf-8" />
</head>
<body onload="getAuthCode()">
	<div id="DivAuthCode"></div>


	<script>
		function getAuthCode() {
			debugger;
			var queryString = location.search;
			
			if (queryString){
				var queryParams = queryString.split('?')[1].split('&');
				if (queryParams){
					var auth_code = '';
					var redirect_url = '';
					var state = '';
					
					for(var i = 0 ; i < queryParams.length; i++){
						var param = queryParams[i];
						
						var paramSplit = param.split('=');
						if (paramSplit && paramSplit.length == 2){
							switch(paramSplit[0].toLowerCase()){
								case "code":
									auth_code = paramSplit[1];
									break;
								case "state":
									state = decodeURIComponent(paramSplit[1]);
									break;
								default:
									break;							
							}
						}
					}
					
					redirect_url = window.atob(state);
					
					if (redirect_url.indexOf('?') > 0)
						redirect_url += "&code=" + auth_code;					
					else 
						redirect_url += "?code=" + auth_code;
					
					alert('Url to redirect : ' + redirect_url);
					
					location.href = redirect_url;
				}
			}
		}
	</script>

</body>
</html>
