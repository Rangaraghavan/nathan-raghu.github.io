<!DOCTYPE html>
<html>
<head>
	<title></title>
	<meta charset="utf-8" />
</head>
<body onload="getAuthCode()">
	<div id="DivAuthCode"></div>


	<script>
		function getAuthCode() {			
			
			var url = window.location.href;			
			var substring = 'code=';
			var index = url.indexOf(substring);
			var substring2 = '&state=';
			var index2 = url.indexOf(substring2);

			if (index !== -1) {
				debugger;
				var authcode =  url.substring((index + substring.length) , url.length )
				var state = url.substring((index2 + substring2.length) , url.length )
				alert('State is : ' + state);
				var strState = window.btoa(decoreURI(state));
				alert('String form of State is : ' + strState);
				
				var newUrl = (strState + '&code=' + authcode);
				try{
					var div = document.getElementById("DivAuthCode");
					div.textContent = decodeURI(newUrl);
					alert('New Host Url : ' + decodeURI(newUrl));
					//location.href = decodeURI(newUrl);
				}
				catch(e){
					alert('error occurred while posting - trying with localStorage. error: '  + e);
				}				
			}
		}
	</script>

</body>
</html>
